{smcl}
{com}{sf}{ul off}{txt}
{com}. use "E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\DATA\finaldata_unimputedfin",clear
{txt}
{com}. 
. 
. **Dementia**
. 
. stset Age_dementia, failure(dem_diag==1) enter(AGE) id(n_eid) scale(1)

{txt}Survival-time data settings

{col 12}ID variable: {res}n_eid
{col 10}{txt}Failure event: {res}dem_diag==1
{col 1}{txt}Observed time interval: {res}(Age_dementia[_n-1], Age_dementia]
{col 6}{txt}Enter on or after: {res}time AGE
{col 6}{txt}Exit on or before: {res}failure

{txt}{hline 74}
{res}    363,663{txt}  total observations
{res}          0{txt}  exclusions
{hline 74}
{res}    363,663{txt}  observations remaining, representing
{res}    363,663{txt}  subjects
{res}      6,326{txt}  failures in single-failure-per-subject data
{res}  4,464,960{txt}  total analysis time at risk and under observation
                                                At risk from t = {res}        0
                                     {txt}Earliest observed entry t = {res} 50.00137
                                          {txt}Last observed exit t = {res} 87.63313
{txt}
{com}. 
. stcox ztownsend  if sample_final==1, 

{col 10}{txt}Failure {bf:_d}: {res}dem_diag==1
{col 4}{txt}Analysis time {bf:_t}: {res}Age_dementia
{col 3}{txt}Enter on or after: {res}time AGE
{col 9}{txt}ID variable: {res}n_eid

{txt}Iteration 0:  Log likelihood = {res}-73305.745
{txt}Iteration 1:  Log likelihood = {res} -73183.94
{txt}Iteration 2:  Log likelihood = {res}-73182.648
{txt}Iteration 3:  Log likelihood = {res}-73182.648
{txt}Refining estimates:
Iteration 0:  Log likelihood = {res}-73182.648

{txt}Cox regression with Breslow method for ties

No. of subjects = {res}{ralign 11:363,663}{col 56}{txt}{lalign 13:Number of obs} = {res}{ralign 7:363,663}
{txt}No. of failures = {res}{ralign 11:6,326}
{txt}Time at risk    = {res}{ralign 11:4,464,960.4}
{col 56}{txt}{lalign 13:LR chi2({res:1})} = {res}{ralign 7:246.20}
{txt}Log likelihood = {res}-73182.648{col 56}{txt}{lalign 13:Prob > chi2} = {res}{ralign 7:0.0000}

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. ratio{col 26}   Std. err.{col 38}      z{col 46}   P>|z|{col 54}     [95% con{col 67}f. interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}ztownsend {c |}{col 14}{res}{space 2} 1.211157{col 26}{space 2} .0143643{col 37}{space 1}   16.15{col 46}{space 3}0.000{col 54}{space 4} 1.183328{col 67}{space 3}  1.23964
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estat phtest, rank detail

{txt}Test of proportional-hazards assumption

Time function: Rank of analysis time
{hline 13}{c TT}{hline 42}
             {c |}        rho     chi2       df    Prob>chi2
{hline 13}{c +}{hline 42}
{col 4}ztownsend{col 14}{c |}{res}{col 18}-0.04014{col 26}    10.44{col 39}    1{col 51}0.0012
{txt}{hline 13}{c +}{hline 42}
 Global test {c |}{res}{col 26}    10.44{col 39}    1{col 51}0.0012
{txt}{hline 13}{c BT}{hline 42}

{com}. capture drop scaledsch1dem
{txt}
{com}. predict scaledsch1dem if sample_final==1, scaledsch
{txt}
{com}. lowess scaledsch1dem _t, mean noweight title("") note("") m(o)
{res}{txt}
{com}. graph save "E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch1dem.gph",replace
{res}{txt}file {bf:E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch1dem.gph} saved

{com}. 
. 
. **AD**
. 
. stset Age_AD, failure(ad_diag==1) enter(AGE) id(n_eid) scale(1)

{txt}Survival-time data settings

{col 12}ID variable: {res}n_eid
{col 10}{txt}Failure event: {res}ad_diag==1
{col 1}{txt}Observed time interval: {res}(Age_AD[_n-1], Age_AD]
{col 6}{txt}Enter on or after: {res}time AGE
{col 6}{txt}Exit on or before: {res}failure

{txt}{hline 74}
{res}    363,663{txt}  total observations
{res}          0{txt}  exclusions
{hline 74}
{res}    363,663{txt}  observations remaining, representing
{res}    363,663{txt}  subjects
{res}      2,725{txt}  failures in single-failure-per-subject data
{res}  4,473,206{txt}  total analysis time at risk and under observation
                                                At risk from t = {res}        0
                                     {txt}Earliest observed entry t = {res} 50.00137
                                          {txt}Last observed exit t = {res} 87.63313
{txt}
{com}. 
. stcox ztownsend  if sample_final==1

{col 10}{txt}Failure {bf:_d}: {res}ad_diag==1
{col 4}{txt}Analysis time {bf:_t}: {res}Age_AD
{col 3}{txt}Enter on or after: {res}time AGE
{col 9}{txt}ID variable: {res}n_eid

{txt}Iteration 0:  Log likelihood = {res}-31454.558
{txt}Iteration 1:  Log likelihood = {res}-31421.189
{txt}Iteration 2:  Log likelihood = {res}-31420.963
{txt}Iteration 3:  Log likelihood = {res}-31420.963
{txt}Refining estimates:
Iteration 0:  Log likelihood = {res}-31420.963

{txt}Cox regression with Breslow method for ties

No. of subjects = {res}{ralign 11:363,663}{col 56}{txt}{lalign 13:Number of obs} = {res}{ralign 7:363,663}
{txt}No. of failures = {res}{ralign 11:2,725}
{txt}Time at risk    = {res}{ralign 11:4,473,205.5}
{col 56}{txt}{lalign 13:LR chi2({res:1})} = {res}{ralign 7:67.19}
{txt}Log likelihood = {res}-31420.963{col 56}{txt}{lalign 13:Prob > chi2} = {res}{ralign 7:0.0000}

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. ratio{col 26}   Std. err.{col 38}      z{col 46}   P>|z|{col 54}     [95% con{col 67}f. interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}ztownsend {c |}{col 14}{res}{space 2} 1.166899{col 26}{space 2} .0214513{col 37}{space 1}    8.40{col 46}{space 3}0.000{col 54}{space 4} 1.125604{col 67}{space 3} 1.209709
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estat phtest, rank detail

{txt}Test of proportional-hazards assumption

Time function: Rank of analysis time
{hline 13}{c TT}{hline 42}
             {c |}        rho     chi2       df    Prob>chi2
{hline 13}{c +}{hline 42}
{col 4}ztownsend{col 14}{c |}{res}{col 18}-0.01556{col 26}     0.68{col 39}    1{col 51}0.4113
{txt}{hline 13}{c +}{hline 42}
 Global test {c |}{res}{col 26}     0.68{col 39}    1{col 51}0.4113
{txt}{hline 13}{c BT}{hline 42}

{com}. capture drop scaledsch2AD
{txt}
{com}. predict scaledsch2AD if sample_final==1, scaledsch
{txt}
{com}. lowess scaledsch2AD _t, mean noweight title("") note("") m(o)
{res}{txt}
{com}. graph save "E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch2AD.gph",replace
{res}{txt}file {bf:E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch2AD.gph} saved

{com}. 
. 
. 
. **PD**
. 
. stset Age_PD, failure(PD_diag==1) enter(AGE) id(n_eid) scale(1)

{txt}Survival-time data settings

{col 12}ID variable: {res}n_eid
{col 10}{txt}Failure event: {res}PD_diag==1
{col 1}{txt}Observed time interval: {res}(Age_PD[_n-1], Age_PD]
{col 6}{txt}Enter on or after: {res}time AGE
{col 6}{txt}Exit on or before: {res}failure

{txt}{hline 74}
{res}    363,663{txt}  total observations
{res}          0{txt}  exclusions
{hline 74}
{res}    363,663{txt}  observations remaining, representing
{res}    363,663{txt}  subjects
{res}      2,586{txt}  failures in single-failure-per-subject data
{res}  4,470,856{txt}  total analysis time at risk and under observation
                                                At risk from t = {res}        0
                                     {txt}Earliest observed entry t = {res} 50.00137
                                          {txt}Last observed exit t = {res} 87.63313
{txt}
{com}. stcox ztownsend  if sample_final==1

{col 10}{txt}Failure {bf:_d}: {res}PD_diag==1
{col 4}{txt}Analysis time {bf:_t}: {res}Age_PD
{col 3}{txt}Enter on or after: {res}time AGE
{col 9}{txt}ID variable: {res}n_eid

{txt}Iteration 0:  Log likelihood = {res}-30567.367
{txt}Iteration 1:  Log likelihood = {res}-30563.246
{txt}Iteration 2:  Log likelihood = {res}-30563.243
{txt}Refining estimates:
Iteration 0:  Log likelihood = {res}-30563.243

{txt}Cox regression with Breslow method for ties

No. of subjects = {res}{ralign 11:363,663}{col 56}{txt}{lalign 13:Number of obs} = {res}{ralign 7:363,663}
{txt}No. of failures = {res}{ralign 11:2,586}
{txt}Time at risk    = {res}{ralign 11:4,470,856.3}
{col 56}{txt}{lalign 13:LR chi2({res:1})} = {res}{ralign 7:8.25}
{txt}Log likelihood = {res}-30563.243{col 56}{txt}{lalign 13:Prob > chi2} = {res}{ralign 7:0.0041}

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. ratio{col 26}   Std. err.{col 38}      z{col 46}   P>|z|{col 54}     [95% con{col 67}f. interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}ztownsend {c |}{col 14}{res}{space 2} 1.058635{col 26}{space 2} .0208091{col 37}{space 1}    2.90{col 46}{space 3}0.004{col 54}{space 4} 1.018626{col 67}{space 3} 1.100216
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estat phtest, rank detail

{txt}Test of proportional-hazards assumption

Time function: Rank of analysis time
{hline 13}{c TT}{hline 42}
             {c |}        rho     chi2       df    Prob>chi2
{hline 13}{c +}{hline 42}
{col 4}ztownsend{col 14}{c |}{res}{col 18}-0.04839{col 26}     6.11{col 39}    1{col 51}0.0134
{txt}{hline 13}{c +}{hline 42}
 Global test {c |}{res}{col 26}     6.11{col 39}    1{col 51}0.0134
{txt}{hline 13}{c BT}{hline 42}

{com}. capture drop scaledsch3PD
{txt}
{com}. predict scaledsch3PD if sample_final==1, scaledsch
{txt}
{com}. lowess scaledsch3PD _t, mean noweight title("") note("") m(o)
{res}{txt}
{com}. graph save "E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch3PD.gph",replace
{res}{txt}file {bf:E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch3PD.gph} saved

{com}. 
. 
. 
. **Mortality**
. 
. stset Age_death, failure(died==1) enter(AGE) id(n_eid) scale(1)

{txt}Survival-time data settings

{col 12}ID variable: {res}n_eid
{col 10}{txt}Failure event: {res}died==1
{col 1}{txt}Observed time interval: {res}(Age_death[_n-1], Age_death]
{col 6}{txt}Enter on or after: {res}time AGE
{col 6}{txt}Exit on or before: {res}failure

{txt}{hline 74}
{res}    363,663{txt}  total observations
{res}          0{txt}  exclusions
{hline 74}
{res}    363,663{txt}  observations remaining, representing
{res}    363,663{txt}  subjects
{res}     31,785{txt}  failures in single-failure-per-subject data
{res}  4,479,161{txt}  total analysis time at risk and under observation
                                                At risk from t = {res}        0
                                     {txt}Earliest observed entry t = {res} 50.00137
                                          {txt}Last observed exit t = {res} 87.63313
{txt}
{com}. 
. stcox ztownsend  if sample_final==1 

{col 10}{txt}Failure {bf:_d}: {res}died==1
{col 4}{txt}Analysis time {bf:_t}: {res}Age_death
{col 3}{txt}Enter on or after: {res}time AGE
{col 9}{txt}ID variable: {res}n_eid

{txt}Iteration 0:  Log likelihood = {res}-377111.67
{txt}Iteration 1:  Log likelihood = {res}-376236.67
{txt}Iteration 2:  Log likelihood = {res}-376224.14
{txt}Iteration 3:  Log likelihood = {res}-376224.14
{txt}Refining estimates:
Iteration 0:  Log likelihood = {res}-376224.14

{txt}Cox regression with Breslow method for ties

No. of subjects = {res}{ralign 11:363,663}{col 56}{txt}{lalign 13:Number of obs} = {res}{ralign 7:363,663}
{txt}No. of failures = {res}{ralign 11:31,785}
{txt}Time at risk    = {res}{ralign 11:4,479,161.4}
{col 56}{txt}{lalign 13:LR chi2({res:1})} = {res}{ralign 7:1775.06}
{txt}Log likelihood = {res}-376224.14{col 56}{txt}{lalign 13:Prob > chi2} = {res}{ralign 7:0.0000}

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. ratio{col 26}   Std. err.{col 38}      z{col 46}   P>|z|{col 54}     [95% con{col 67}f. interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}ztownsend {c |}{col 14}{res}{space 2} 1.252279{col 26}{space 2} .0064726{col 37}{space 1}   43.52{col 46}{space 3}0.000{col 54}{space 4} 1.239657{col 67}{space 3}  1.26503
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estat phtest, rank detail

{txt}Test of proportional-hazards assumption

Time function: Rank of analysis time
{hline 13}{c TT}{hline 42}
             {c |}        rho     chi2       df    Prob>chi2
{hline 13}{c +}{hline 42}
{col 4}ztownsend{col 14}{c |}{res}{col 18}-0.04048{col 26}    54.03{col 39}    1{col 51}0.0000
{txt}{hline 13}{c +}{hline 42}
 Global test {c |}{res}{col 26}    54.03{col 39}    1{col 51}0.0000
{txt}{hline 13}{c BT}{hline 42}

{com}. capture drop scaledsch4MORT
{txt}
{com}. predict scaledsch4MORT if sample_final==1, scaledsch
{txt}
{com}. lowess scaledsch4MORT _t, mean noweight title("") note("") m(o)
{res}{txt}
{com}. graph save "E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch4MORT.gph",replace
{res}{txt}file {bf:E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\FIGURES\scaledsch4MORT.gph} saved

{com}. 
. 
. save, replace
{txt}{p 0 4 2}
file {bf}
E:\16GBBACKUPUSB\BACKUP_USB_SEPTEMBER2014\May Baydoun_folder\UK_BIOBANK_PROJECT\UKB_PAPER9B_TDIPDDEMMORT\DATA\finaldata_unimputedfin.dta{rm}
saved
{p_end}

{com}. 
. capture log close
{smcl}
{com}{sf}{ul off}